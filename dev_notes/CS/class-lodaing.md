# 클래스 로딩이란?
+ JVM이 .class 파일을 메모리에 올려 실행 준비를 하는 과정
  + 자바 프로그램은 실행 전에 모든 클래스를 미리 메모리에 올리지 않는다
  + 필요할 때 로딩: LAZY
+ 위 로딩 작업을 담당하는 것이 `ClassLoader`

---

## 클래스 로딩 프로세스
| 단계 | 설명 |
| --- | --- |
| Loading | .class 파일을 메모리로 읽어오는 단계<br>클래스로더가 담당 |
| Linking | Verification: 클래스가 JVM 규칙에 맞는지 체크<br>Preparation: static 필드 메모리 할당, 기본 값 설정<br>Resolution: 심볼릭 레퍼런스를 실제 메모리 주소로 변경 |
| Initialication | static 블록 실행, static 필드 초기값 할당 등 실제 동작 전 준비 완료 |

---

### 계층적 로딩 원칙 (위임 모델)
1. ClassLoader가 클래스를 로딩할 때 먼저 부모 로더에게 로딩 요청
2. 부모 로더가 해당 클래스를 찾지 못하면, 자식 로더가 직접 로딩 시도
>`위임 모델`

#### 장점
+ JVM 핵심 클래스가 항상 우선 -> 사용자 정의 클래스가 핵심 클래스를 오염시키는 걸 방지 
>보안 & 일관성 유지

## 클래스 로딩은 언제 로딩 되는가?
+ 클래스는 `처음 참조될 때` 로딩된다
  + new 연산자 호출
  + static 메서드/필드 참조
  + Class.forName() 호출
  + 자바 리플렉션 사용
> JVM은 지연 로딩 방식을 택한다

## ClassLoader와 Class의 메모리 구조 - 어디에 올라가나?
| 구분 | 설명 |
| --- | --- |
| Method Area | 클래스 구조 정보, static 변수 저장 |
| Heap | new 로 생성한 인스턴스(객체) 저장 |
| Stack | 메서드 호툴 시 프레임 생성, 지역 변수 저장 |
| PC Register | 현재 실행 중인 명령어 주소 저장 |

---

## 정리
1. 클래스 로딩은 `로딩-링크-초기화`의 단계로 이루어진다
2. ClassLoader는 계층적으로(부모 -> 자식)으로 동작
    + 부모 우선 로딩을 원칙으로 한다
3. `부트스트랩 -> 확장 -> 애플리케이션 -> 사용자 정의`순서로 클래스 로더가 구성된다
4. JVM은 필요할 때만 클래스를 메모리에 로딩: 지연 로딩
5. 클래스 정보는 `메서드 영역`에 로딩된다
