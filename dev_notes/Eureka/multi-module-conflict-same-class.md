# 멀티 모듈 구조에서 중복되는 클래스의 문제 및 해결

---

```text
멀티 모듈 구조에서 서브 프로젝트 부분을 먼저 진행하게 되었다.
이후 메인에서도 필요한 동일 클래스 발생 상황이 생겼다.

1. 중복되어도 괜찮을까?
2. 더욱 가치가 높은 메인을 중심으로 의존성을 부여할까?
3. 이름만 변경으로 동일한 기능의 클래스 추가?
```

---

## 중복이어도 괜찮을까?
### 각각의 패키지에 같은 이름으로 두는 방법 (CQRS 분리형)
+ 언제 사용?
  + CQRS가 확실히 분리된 경우 (쓰기/읽기 분리)
  + DB에 대하여 Write, Read의 각각의 담당이 정해져 있는 경우(책임이 다를 때)
  + 트랜잭션 경계나 로직이 다른데 굳이 하나의 Repository로 얽히기 싫을 때
+ 단점
  + 코드 중복으로 보일 수 있다 (사실은 분리된 책임이다)
  + 확실한 설계 철학이 있어야 한다 (CQRS 모르면 혼란)

## 의존성을 공유?
### 메인 모듈에 클래스를 두고 의존성을 공유하는 방법 (통합형)
+ 언제 사용?
  + 쓰기/읽기 책임이 명확히 분리되어 있지 않거나, 규모가 작을 때
  + 해당 Repository가 너무 단순해서 CQRS 분리까지 필요 없을 때
  + 모듈 사이의 의존성이 적절하고, 복잡성보다 재사용성이 더 중요할 때
+ 단점
  + 규모가 커지면 모든 의존성들에 의해 애매한 거대 공통 모듈이 된다
  + CQRS 도입 시, 읽기/쓰기 트랜잭션 경계가 엉킬 가능성 존재

## 클래스명만 다른 동일 기능?
### 이름을 다르게 해서 분리하는 방법
+ 언제 사용?
  + 코드상 명확하게 책임을 이름으로 구분하고 싶을 때 (협업/가독성 차원)
  + CQRS를 소프트하게 적용할 때 (모듈 경계는 약하게 + 개념을 살리게)
  + Respsitory 커스텀 메서드 구현이 달라질 가능성이 있을 때
+ 단점
  + 결국 같은 Entity를 두고 '이름만' 구분
    + 실질적으로 한 구현체에서 얽힐 수 있다
  + 완전한 CQRS 아키텍처는 아니기 때문에, 확장성이 모호할 수 있다